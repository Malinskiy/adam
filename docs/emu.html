<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/adam/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/adam/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-185620090-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-185620090-1', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/adam/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/adam/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Emulator | Adam</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Emulator" /><meta property="og:locale" content="en_US" /><meta name="description" content="There are three ways to control an emulator:" /><meta property="og:description" content="There are three ways to control an emulator:" /><link rel="canonical" href="https://malinskiy.github.io/adam/docs/emu" /><meta property="og:url" content="https://malinskiy.github.io/adam/docs/emu" /><meta property="og:site_name" content="Adam" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-02-10T01:41:36+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Emulator" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://malinskiy.github.io/adam/docs/emu"},"description":"There are three ways to control an emulator:","url":"https://malinskiy.github.io/adam/docs/emu","@type":"BlogPosting","headline":"Emulator","dateModified":"2025-02-10T01:41:36+00:00","datePublished":"2025-02-10T01:41:36+00:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://malinskiy.github.io/adam/assets/images/adam.png"}},"@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="https://malinskiy.github.io/adam/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><div class="nav-category">Documentation</div><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://malinskiy.github.io/adam/docs/shell" class="nav-list-link">Shell</a><ul class="nav-list "><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/shell/shell-v2/" class="nav-list-link">Shell v2</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://malinskiy.github.io/adam/docs/package-management/package-management/" class="nav-list-link">Package management</a><ul class="nav-list "><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/package-management/sideload/" class="nav-list-link">Sideload</a></ul><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/monitor-devices" class="nav-list-link">Device management</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://malinskiy.github.io/adam/docs/files" class="nav-list-link">Files</a><ul class="nav-list "><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/files/recommended/" class="nav-list-link">Recommended mode</a><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/files/compat/" class="nav-list-link">Compatibility mode</a><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/files/sync-v1/" class="nav-list-link">sync v1</a><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/files/sync-v2/" class="nav-list-link">sync v2</a><li class="nav-list-item "><a href="https://malinskiy.github.io/adam/docs/files/ls/" class="nav-list-link">ls wrapper</a></ul><li class="nav-list-item active"><a href="https://malinskiy.github.io/adam/docs/emu" class="nav-list-link active">Emulator</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/props/get-properties/" class="nav-list-link">Device properties (getprop)</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/instrumentation/test-runner/" class="nav-list-link">Test runner (am instrument)</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/screen-capture/screenshot/" class="nav-list-link">Screenshot</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/logcat/logcat/" class="nav-list-link">Logcat</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/port-forwarding/port-forwarding/" class="nav-list-link">Port forwarding</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/abb" class="nav-list-link">Android Binder Bridge</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/adbd" class="nav-list-link">adbd (on-device)</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/misc/misc/" class="nav-list-link">Miscellaneous</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/caveats/" class="nav-list-link">Caveats</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/docs/api/" class="nav-list-link">API</a></ul><div class="nav-category">Tutorials</div><ul class="nav-list"><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/tutorials/1-shell/" class="nav-list-link">1. Execute shell request</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/tutorials/2-logcat/" class="nav-list-link">2. Stream logcat</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/tutorials/3-install-package/" class="nav-list-link">3. Install package</a></ul><div class="nav-category">Add-ons</div><ul class="nav-list"><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/extensions/1-android-junit/" class="nav-list-link">Android JUnit 4 rules</a><li class="nav-list-item"><a href="https://malinskiy.github.io/adam/extensions/2-android-event-producers/" class="nav-list-link">Android test metric producers</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Adam" aria-label="Search Adam" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/Malinskiy/adam" class="site-button" > Adam on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main"><p>There are three ways to control an emulator:</p><ol><li>Regular adb commands<li>Using a console port<li>Using a gRPC port</ol><p>At boot time each emulator allocates 2 ports on the hostâ€™s loopback interface: a <em>console</em> port and a <em>gRPC</em> bridge port. The console port can be established using the serial number of emulator, for example <code class="language-plaintext highlighter-rouge">emulator-5554</code>â€™s console port is 5554, <code class="language-plaintext highlighter-rouge">emulator-5556</code> - 5556. If you want to make sure emulator uses a particular console port you can start the emulator with a parameter:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>emulator @Nexus_5X_API_23 <span class="nt">-port</span> &lt;port&gt;
</code></pre></div></div><p>gRPC bridge port is usually calculated as <code class="language-plaintext highlighter-rouge">console port + 3000</code>, so for <code class="language-plaintext highlighter-rouge">emulator-5554</code> default gRPC port will be 8554. If you want to make sure emulator uses a particular grpc bridge port you can start the emulator with a parameter:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>emulator @Nexus_5X_API_23 <span class="nt">-grpc</span> &lt;port&gt;
</code></pre></div></div><h2 id="run-emulator-console-command"> <a href="#run-emulator-console-command" class="anchor-heading" aria-labelledby="run-emulator-console-command"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Run emulator console command</h2><p>This request will execute an emulator console command:</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">devices</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">Device</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">adb</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span>
    <span class="n">request</span> <span class="p">=</span>
    <span class="nc">EmulatorCommandRequest</span><span class="p">(</span>
        <span class="s">"help"</span><span class="p">,</span>
        <span class="nc">InetSocketAddress</span><span class="p">(</span><span class="s">"localhost"</span><span class="p">,</span> <span class="mi">5556</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>This request is completely different to other requests: it connects directly to emulator instead of adb server. For simplicity, it can be used in the same way as adb server requests and shares the socket creation logic with other requests.</p><h2 id="run-grpc-bridge-commands"> <a href="#run-grpc-bridge-commands" class="anchor-heading" aria-labelledby="run-grpc-bridge-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Run gRPC bridge commands</h2><p>Adam bundles a gRPC client for emulator gRPC bridge. The spec is generated from <a href="https://android.googlesource.com/platform/prebuilts/android-emulator/+/master/linux-x86_64/lib/emulator_controller.proto" title="emulator_controller.proto">emulator_controller.proto</a></p><p>Please refer to the gRPC docs on using the client. A very simple example looks something like this:</p><div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">channel</span> <span class="p">=</span> <span class="nc">ManagedChannelBuilder</span><span class="p">.</span><span class="nf">forAddress</span><span class="p">(</span><span class="n">grpcHost</span><span class="p">,</span> <span class="n">grpcPort</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span>
    <span class="nf">usePlaintext</span><span class="p">()</span>
    <span class="nf">executor</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">.</span><span class="nf">asExecutor</span><span class="p">())</span>
<span class="p">}.</span><span class="nf">build</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">client</span> <span class="p">=</span> <span class="nc">EmulatorControllerGrpcKt</span><span class="p">.</span><span class="nc">EmulatorControllerCoroutineStub</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">state</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">getVmState</span><span class="p">(</span><span class="nc">Empty</span><span class="p">.</span><span class="nf">getDefaultInstance</span><span class="p">())</span>
</code></pre></div></div><p>Please refer to the <a href="https://android.googlesource.com/platform/prebuilts/android-emulator/+/master/linux-x86_64/lib/emulator_controller.proto" title="emulator_controller.proto">emulator_controller.proto</a> for the supported functionality.</p><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/Malinskiy/adam/tree/master/docs/_docs/emulator/emulator.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div>
